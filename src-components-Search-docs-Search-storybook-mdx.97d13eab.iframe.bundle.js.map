{"version":3,"file":"src-components-Search-docs-Search-storybook-mdx.97d13eab.iframe.bundle.js","mappings":";;;AAoBA;;;;AAIA;AACA;;;AAKA;;AAEA;;AAQA;;;;AAIA;AAEA;AACA;;AAIA;;;;AAIA;;;;;;;;;;;;;;;;;;AAkBA;;;;AAgEA;ACxGA;;ACgBA;AAuBA;AACA;;;;AAIA","sources":["webpack://@freenow/wave/./src/components/Search/Search.tsx","webpack://@freenow/wave/./src/components/Box/Box.tsx","webpack://@freenow/wave/./src/components/Text/Text.tsx"],"sourcesContent":["import { FC } from 'react';\nimport * as React from 'react';\n\nimport styled from 'styled-components';\nimport { Colors, Elevation } from '../../essentials';\nimport { CloseIcon, MagnifyingGlassIcon } from '../../icons/index';\nimport { useControlledState } from '../../utils/hooks/useControlledState';\nimport { Box, BoxProps } from '../Box/Box';\n\nimport { Input } from '../Input/Input';\n\nconst ActiveStyle = `\n    background-color: ${Colors.ACTION_BLUE_50};\n    color: ${Colors.ACTION_BLUE_900};\n`;\n\ninterface SearchResultsContainerProps extends BoxProps, Pick<SearchProps, 'inverted'> {}\n\nconst SearchResultsContainer = styled(Box)<SearchResultsContainerProps>`\n    position: absolute;\n    z-index: ${Elevation.SUGGESTIONS_LIST};\n    margin-top: 0.0625rem;\n    padding: 0.25rem 0;\n    width: inherit;\n    background-color: ${props => (props.inverted ? Colors.AUTHENTIC_BLUE_900 : Colors.WHITE)};\n    box-shadow: 0 0.125rem 0.5rem 0.0625rem ${Colors.AUTHENTIC_BLUE_200};\n    border-radius: 0.25rem;\n    cursor: pointer;\n`;\n\nconst ActiveBox = styled(Box)`\n    &[aria-selected='true'] > div {\n        ${ActiveStyle}\n    }\n`;\n\ninterface SearchInputContainerProps extends BoxProps {\n    isInFocus: boolean;\n}\n\nconst SearchInputContainer = styled(Box)<SearchInputContainerProps>`\n    box-sizing: border-box;\n    background: white;\n    border-radius: 0.25rem;\n    border: ${p =>\n        p.isInFocus ? `0.0625rem solid ${Colors.ACTION_BLUE_900}` : `0.0625rem solid ${Colors.AUTHENTIC_BLUE_200}`};\n    box-shadow: ${p => (p.isInFocus ? `inset 0 0 0 0.0625rem ${Colors.ACTION_BLUE_900}` : 'none')};\n    height: ${p => (p.size === 'small' ? '2.2rem' : '3.2rem')};\n    transition: box-shadow 100ms ease, border 100ms ease;\n`;\n\nconst StyledInput = styled(Input)`\n    width: 100%;\n\n    input {\n        caret-color: ${Colors.ACTION_BLUE_900};\n        background: transparent;\n        border: 0;\n\n        &:focus,\n        &:active {\n            outline: 0;\n            border: 0;\n            box-shadow: unset;\n        }\n\n        text-overflow: ellipsis;\n\n        ::-webkit-search-cancel-button {\n            display: none;\n        }\n\n        &::placeholder {\n            color: ${p => (!p.disabled ? Colors.AUTHENTIC_BLUE_550 : Colors.AUTHENTIC_BLUE_200)};\n            opacity: 1;\n        }\n    }\n`;\n\nexport interface SearchProps {\n    results?: React.ReactNode[];\n    /**\n     * Sets the value\n     */\n    value?: string;\n    /**\n     * Function to set the value\n     */\n    setValue?: (value: string) => void;\n    /**\n     * show results dropdown\n     */\n    showResults?: boolean;\n    /**\n     * Function to show and hide the dropdown\n     */\n    setShowResults?: (value: boolean) => void;\n    /**\n     * Sets the width of the search box\n     */\n    width?: string;\n    /**\n     * Sets the placeholder text to be shown\n     */\n    placeholder?: string;\n    /**\n     * Determines whether the search box is disabled\n     */\n    disabled?: boolean;\n    /**\n     * Determines whether the search box has an inverted color scheme\n     */\n    inverted?: boolean;\n    /**\n     * Determines the size of the search box\n     */\n    size?: 'small' | 'medium';\n    /**\n     * This function is called when the \"Enter\" key is pressed or the search icon is clicked\n     */\n    onEnter?: (value: string) => void;\n    /**\n     * This function is called when the selection is changed. It emits the selected index\n     */\n    onChangeSelection?: (index: number) => void;\n    /**\n     * This function is called when the value in the search box changes\n     */\n    onInputChange?: (value: string) => void;\n    /**\n     * This function is called when the search box is cleared\n     */\n    onClear?: () => void;\n}\n\nconst prefix = 'result-item';\n\nexport const Search: FC<SearchProps> = ({\n    results = [],\n    value: propsValue,\n    setValue: setPropsValue,\n    showResults: propsShowResults,\n    setShowResults: setPropsShowResults,\n    width,\n    placeholder = 'Search...',\n    disabled,\n    inverted,\n    size,\n    onInputChange,\n    onClear,\n    onEnter,\n    onChangeSelection\n}: SearchProps) => {\n    const containerRef = React.useRef<HTMLDivElement>(null);\n\n    const [isInFocus, setIsInFocus] = React.useState<boolean>(false);\n\n    const [activeIndex, setActiveIndex] = React.useState<number>(0);\n\n    const [value, setValue] = useControlledState<string>([propsValue, setPropsValue], '');\n\n    const [showResults, setShowResults] = useControlledState<boolean>([propsShowResults, setPropsShowResults], false);\n\n    // this is to keep track of keypress events (up, down, enter, escape)\n    React.useEffect(() => {\n        // we're trying to calculate how many search result options will be rendered, to enable moving up and down through them\n        // if we specify customResultLength, that will be taken.\n        // if not, we'll check if children is an array, and if so take its length\n        // if not just assume there is only one child\n        const elementLength: number = Array.isArray(results) ? results.length : 1;\n\n        // emits onChangeSelection on ArrowDown and ArrowUp, onEnter on Enter, onBlur on Escape\n        const emitKeyEvent = ({ key }: KeyboardEvent) => {\n            if (!isInFocus) return;\n            switch (key) {\n                case 'ArrowUp': {\n                    const index = activeIndex > 0 ? (activeIndex - 1) % elementLength : elementLength - 1;\n                    setActiveIndex(index);\n                    onChangeSelection?.(index);\n                    break;\n                }\n\n                case 'ArrowDown': {\n                    const index = (activeIndex + 1) % elementLength;\n                    setActiveIndex(index);\n                    onChangeSelection?.(index);\n                    break;\n                }\n\n                case 'Enter': {\n                    const el = document.querySelector(`#${prefix}-${activeIndex}`);\n                    (el?.children[0] as HTMLElement)?.click();\n                    onEnter?.(value);\n                    break;\n                }\n\n                case 'Escape':\n                    setShowResults(false);\n                    break;\n\n                default:\n                    break;\n            }\n        };\n        document.addEventListener('keydown', emitKeyEvent);\n        return () => {\n            document.removeEventListener('keydown', emitKeyEvent);\n        };\n    }, [isInFocus, activeIndex, setActiveIndex, onChangeSelection, onEnter, value, propsValue, results]);\n\n    // this is to keep track of clicks outside the component (useful to close the search results)\n    React.useEffect(() => {\n        // eslint-disable-next-line unicorn/consistent-function-scoping\n        const emitIfClickingOutsideSearch = (event: DocumentEventMap['click']) => {\n            if (disabled) return;\n            if (!containerRef.current.contains(event.target as Element)) {\n                setShowResults(false);\n            } else {\n                setShowResults(true);\n            }\n        };\n        document.addEventListener('click', emitIfClickingOutsideSearch);\n        return () => {\n            document.removeEventListener('click', emitIfClickingOutsideSearch);\n        };\n    }, [showResults, setShowResults, disabled]);\n\n    const handleChangeValue = (event: React.ChangeEvent<HTMLInputElement>) => {\n        setShowResults(true);\n        const searchText: string = event.target.value;\n        setValue?.(searchText);\n        onInputChange?.(searchText);\n    };\n\n    return (\n        // this is a div to make attaching the ref a walk in the park :)\n        <div\n            ref={containerRef}\n            // give it the width passed down to it\n            style={{\n                width\n            }}\n            role=\"search\"\n        >\n            <SearchInputContainer\n                isInFocus={isInFocus}\n                display=\"flex\"\n                flexDirection=\"row\"\n                alignItems=\"center\"\n                width=\"100%\"\n                size={size}\n            >\n                <Box\n                    // passing styled-system props gives \"No overload matches this call\" lint error.\n                    style={{\n                        display: 'flex',\n                        margin: size === 'small' ? '0.5rem' : '1rem',\n                        marginRight: 'auto'\n                    }}\n                    onClick={() => !disabled && onEnter?.(value)}\n                >\n                    <MagnifyingGlassIcon\n                        size={size === 'small' ? 20 : 24}\n                        aria-hidden=\"true\"\n                        color={!disabled ? Colors.AUTHENTIC_BLUE_350 : Colors.AUTHENTIC_BLUE_200}\n                    />\n                </Box>\n\n                <StyledInput\n                    size={size}\n                    type=\"search\"\n                    inverted={inverted}\n                    disabled={disabled}\n                    aria-label={placeholder}\n                    autoComplete=\"off\"\n                    placeholder={placeholder}\n                    value={value}\n                    onChange={handleChangeValue}\n                    onFocus={() => setIsInFocus(true)}\n                    onBlur={() => setIsInFocus(false)}\n                />\n\n                {!value ? undefined : (\n                    <Box\n                        aria-label=\"clear-search\"\n                        style={{ margin: '1rem', marginLeft: 'auto', cursor: 'pointer', display: 'flex' }}\n                        onClick={() => {\n                            setValue?.('');\n                            onClear?.();\n                        }}\n                        role=\"button\"\n                    >\n                        <CloseIcon aria-hidden=\"true\" color={Colors.AUTHENTIC_BLUE_550} />\n                    </Box>\n                )}\n            </SearchInputContainer>\n\n            {showResults && results.length > 0 && (\n                <SearchResultsContainer inverted={inverted} role=\"listbox\">\n                    {results.map((result, index) => (\n                        <ActiveBox\n                            role=\"option\"\n                            id={`${prefix}-${index}`}\n                            key={\n                                // eslint-disable-next-line react/no-array-index-key\n                                index\n                            }\n                            onMouseEnter={() => setActiveIndex(index)}\n                            onMouseMove={() => setActiveIndex(index)}\n                            aria-selected={activeIndex === index}\n                        >\n                            {result}\n                        </ActiveBox>\n                    ))}\n                </SearchResultsContainer>\n            )}\n        </div>\n    );\n};\n","import styled from 'styled-components';\nimport {\n    background,\n    BackgroundProps,\n    color,\n    ColorProps,\n    compose,\n    flexbox,\n    FlexboxProps,\n    grid,\n    GridProps,\n    layout,\n    LayoutProps,\n    position,\n    PositionProps,\n    space,\n    SpaceProps,\n    textAlign,\n    TextAlignProps\n} from 'styled-system';\nimport { theme } from '../../essentials/theme';\n\ninterface BoxProps\n    extends SpaceProps,\n        LayoutProps,\n        PositionProps,\n        Omit<ColorProps, 'color'>, // HACK: avoid collision of `color` prop\n        FlexboxProps,\n        GridProps,\n        BackgroundProps,\n        TextAlignProps {}\n\nconst Box = styled.div.attrs({ theme })<BoxProps>`\n    ${compose(space, layout, position, color, flexbox, grid, background, textAlign)}\n`;\n\nexport { Box, BoxProps };\n","import { ComponentPropsWithoutRef } from 'react';\nimport styled from 'styled-components';\nimport {\n    compose,\n    fontFamily,\n    FontFamilyProps,\n    fontSize,\n    FontSizeProps,\n    fontWeight,\n    margin,\n    MarginProps,\n    ResponsiveValue,\n    textAlign,\n    TextAlignProps\n} from 'styled-system';\nimport { theme } from '../../essentials/theme';\nimport { get } from '../../utils/themeGet';\nimport { deprecatedProperty } from '../../utils/deprecatedProperty';\n\ninterface TextProps\n    extends ComponentPropsWithoutRef<'span'>,\n        MarginProps,\n        FontSizeProps,\n        FontFamilyProps,\n        TextAlignProps {\n    /**\n     * The font-weight property specifies the weight (or boldness) of the font.\n     * @default normal\n     */\n    fontWeight?: ResponsiveValue<'normal' | 'semibold' | 'bold'>;\n    /**\n     * Adjust color for display on a dark background\n     */\n    inverted?: boolean;\n    /**\n     * Adjust color to indicate secondary information\n     * @deprecated use `secondary` instead\n     */\n    weak?: boolean;\n    /**\n     * Adjust color to indicate secondary information\n     */\n    secondary?: boolean;\n    /**\n     * Adjust color to display a disabled text element\n     */\n    disabled?: boolean;\n}\n\nfunction determineTextColor(props: TextProps) {\n    const { weak, secondary, inverted, disabled } = props;\n    if (weak !== undefined) {\n        deprecatedProperty('Text', weak, 'weak', 'secondary', 'Rename `weak` to `secondary` to remove the warning.');\n    }\n\n    if (disabled) {\n        return get(inverted ? 'semanticColors.text.disabledInverted' : 'semanticColors.text.disabled')(props);\n    }\n\n    if (secondary || weak) {\n        return get(inverted ? 'semanticColors.text.secondaryInverted' : 'semanticColors.text.secondary')(props);\n    }\n\n    if (inverted) {\n        return get('semanticColors.text.primaryInverted')(props);\n    }\n\n    return get('semanticColors.text.primary')(props);\n}\n\nconst Text = styled.span.attrs({ theme })<TextProps>`\n    color: ${determineTextColor};\n    font-size: ${get('fontSizes.2')};\n    font-family: ${get('fonts.normal')};\n    line-height: 1.4;\n    margin: 0;\n\n    ${compose(margin, fontSize, fontWeight, fontFamily, textAlign)}\n`;\n\nexport { Text, TextProps };\n"],"names":[],"sourceRoot":""}